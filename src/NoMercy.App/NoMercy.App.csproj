<Project Sdk="Microsoft.NET.Sdk.Web">

    <PropertyGroup>
        <TargetFramework>net10.0</TargetFramework>
        <ImplicitUsings>enable</ImplicitUsings>
        <Nullable>enable</Nullable>
        <GenerateEmbeddedFilesManifest>true</GenerateEmbeddedFilesManifest>
        <ApplicationIcon>..\..\assets\icons\icon.ico</ApplicationIcon>
        <Authors>NoMercy Entertainment</Authors>
        <Description>NoMercy MediaServer UI Application</Description>
        <Copyright>2025 NoMercy Entertainment</Copyright>
        <PackageProjectUrl>https://nomercy.tv</PackageProjectUrl>
        <PackageIcon>..\..\assets\icons\icon.png</PackageIcon>
        <Company>NoMercy Entertainment</Company>
        <Product>NoMercy App</Product>
        <PublishWithAspNetCoreTargetManifest>false</PublishWithAspNetCoreTargetManifest>
        <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
        <RepositoryUrl>https://github.com/NoMercy-Entertainment/NoMercyMediaServer</RepositoryUrl>
        <PackageTags>streaming media content-management private streaming-video streaming-audio blurayrip video-encoder</PackageTags>
        <NeutralLanguage>en</NeutralLanguage>
        <OutputType>WinExe</OutputType>
    </PropertyGroup>

    <PropertyGroup>
        <IsTestProject>false</IsTestProject>
    </PropertyGroup>

    <PropertyGroup>
        <Platforms>AnyCPU</Platforms>
        <TargetName>NoMercyApp</TargetName>
        <AssemblyName>NoMercyApp</AssemblyName>
        <PublishSingleFile>true</PublishSingleFile>
        <SelfContained>true</SelfContained>
        <IncludeAllContentForSelfExtract>true</IncludeAllContentForSelfExtract>
        <EnableCompressionInSingleFile>true</EnableCompressionInSingleFile>
        <GenerateEmbeddedFilesManifest>true</GenerateEmbeddedFilesManifest>
        <DebugType>None</DebugType>
        <DebugSymbols>false</DebugSymbols>

        <Version>0.0.1</Version>
        <AssemblyVersion>$(Version).0</AssemblyVersion>
        <FileVersion>$(Version).0</FileVersion>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="InfiniLore.InfiniFrame" Version="0.1.0-preview.25" />
        <PackageReference Include="InfiniLore.InfiniFrame.WebServer" Version="0.1.0-preview.25" />
        <PackageReference Include="Microsoft.Extensions.FileProviders.Embedded" Version="10.0.0" />
    </ItemGroup>

    <ItemGroup>
        <EmbeddedResource Include="wwwroot\**" />
        <EmbeddedResource Include="..\..\assets\icons\*.*" Link="Resources\AppIcon\%(Filename)%(Extension)" />
    </ItemGroup>

    <ItemGroup>
        <None Include="wwwroot\**">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
        <None Include="..\..\assets\icons\*.*" Link="Resources\AppIcon\%(Filename)%(Extension)">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
    </ItemGroup>

    <!-- Ensure static assets manifest is included in single-file publish -->
    <Target Name="IncludeStaticAssetsManifest" AfterTargets="GenerateStaticWebAssetsManifest">
        <ItemGroup>
            <ContentWithTargetPath Include="$(IntermediateOutputPath)staticwebassets\**\*.json"
                                   TargetPath="%(Filename)%(Extension)"
                                   CopyToPublishDirectory="PreserveNewest" />
        </ItemGroup>
    </Target>

    <!-- Mark manifest for extraction from single-file bundle -->
    <ItemGroup>
        <Content Update="$(TargetName).staticwebassets.endpoints.json">
            <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
            <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
            <ExcludeFromSingleFile>true</ExcludeFromSingleFile>
        </Content>
    </ItemGroup>

</Project>


